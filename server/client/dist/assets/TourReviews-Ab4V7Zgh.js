import{j as e,r as d,a as x,e as m,u as b,L as y,V as u,v as R}from"./index-JePda7sN.js";import{c as T}from"./index-DMcL_BQd.js";import{d as f}from"./index-DoP08BHp.js";function z({photo:t,userName:a,review:i,ratings:n}){return e.jsxs("div",{className:"mx-auto flex min-h-[19rem] min-w-[20rem] flex-col items-center justify-between space-y-10 rounded bg-white p-8 shadow-lg md:min-h-[300px] md:max-w-[400px] md:min-w-[350px]",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("img",{className:"text-natours size-10 rounded-full shadow",src:t}),e.jsx("p",{className:"font-semibold text-stone-600",children:a})]}),e.jsx("div",{children:e.jsx("p",{className:"text-stone-800/50",children:i})})]}),e.jsx("div",{children:e.jsx(f.Rating,{initialValue:Math.round(n),size:25,readonly:!0,fillColor:"#55c57a"})})]})}function C({tourId:t}){const[a,i]=d.useState(""),[n,c]=d.useState(0),{user:s}=x(),{getCurrentTour:h,currentTour:w}=m(),{loadingWrite:p,writeReview:g}=b(),v=r=>{c(r)};function j(r,l){let o=!0;return!l&&!r?(u.error("You can't submit without review and ratings"),o=!1):r.length<7?(u.error("Please write atleast two words!"),o=!1):l===0?(u.error("You must select ratings"),o=!1):o}async function N(r){r.preventDefault();const l={review:a,rating:n,tour:t,user:s._id};j(a,n)&&(await g(l),await h(w.slug))}return e.jsx("div",{className:"flex min-h-[300px] max-w-md min-w-[300px] flex-col gap-3 space-y-1 rounded bg-white px-8 py-8 shadow-lg",children:e.jsxs("form",{className:"space-y-5",onSubmit:N,children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("img",{className:"text-natours size-10 rounded-full shadow",src:`/img/users/${s.photo}`}),e.jsx("p",{className:"font-semibold text-stone-600",children:s.name})]}),e.jsx("div",{className:"w-full",children:e.jsx("textarea",{rows:4,draggable:"false",value:a,placeholder:"Write your review",onChange:r=>i(r.target.value),className:"focus:ring-natours w-full resize-none rounded border border-stone-400/50 p-2 text-stone-600 outline-none focus:ring-2","aria-label":"Write your review"})}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(f.Rating,{size:25,className:"mx-auto",fillColor:"#55c57a",onClick:v})}),e.jsx("div",{className:"my-1 flex w-full justify-center",children:e.jsx("button",{className:"bg-natours w-full cursor-pointer rounded-full px-3 py-2 font-bold text-white",children:p?e.jsx(y,{}):"Submit"})})]})})}function U(){const{currentTour:t,myBookings:a}=m(),{user:i}=x(),n=a.find(s=>s.tour.id===t.id),c=i&&(t.reviews.length===0||!t.reviews.some(s=>s.user._id===i.id))&&i.role==="user";return e.jsxs("section",{className:"natours-gradient flex flex-col items-center justify-center space-y-5 overflow-hidden",children:[e.jsxs("div",{className:"mt-8 flex flex-col items-center",children:[e.jsxs("p",{className:"flex items-center gap-2 text-2xl font-semibold text-white/80",children:[e.jsx("span",{children:e.jsx(R,{className:"mt-1 p-0"})}),"User Reviews"]}),t.reviews.length!==0&&e.jsxs("p",{className:"text-2xl font-semibold text-white",children:[t.ratingsAverage," / 5"]})]}),e.jsxs("div",{className:"flex min-h-[40vh] w-full items-center justify-evenly gap-10 overflow-x-auto px-10 py-5 pb-15",children:[n&&c&&e.jsx(C,{tourId:t.id}),t.reviews.length===0?e.jsxs("p",{className:"flex flex-col items-center text-2xl font-bold whitespace-nowrap text-white/80 md:text-3xl",children:[e.jsx("span",{children:e.jsx(T,{className:"size-12"})}),"No reviews found!"]}):[...t.reviews].reverse().map(s=>e.jsx(z,{ratings:s.rating,userName:s.user.name,photo:`/img/users/${s.user.photo}`,review:s.review},s._id))]})]})}export{U as default};
